# gametools v1.1.0 更新说明

## 🎉 新功能：Excel拆分工具

### 功能概述
新增了Excel拆分工具，可以根据指定列（默认A列）的唯一值将Excel文件拆分成多个独立的Excel文件。

### 主要特性
- ✅ 支持按任意列拆分Excel文件
- ✅ 自动处理文件名中的非法字符
- ✅ 支持指定工作表名称
- ✅ 提供详细的拆分报告
- ✅ 支持命令行和GUI两种使用方式
- ✅ 多线程处理，界面响应流畅
- ✅ 集成到gametools主程序

### 使用方法

#### 通过主程序使用
1. 启动gametools主程序
2. 点击"Excel拆分工具"页签
3. 选择输入文件和输出目录
4. 设置拆分选项（可选）
5. 点击"开始拆分"按钮

#### 命令行使用
```bash
python tools/excel_splitter/excel_splitter.py input.xlsx output_dir --column 部门
```

### 输出示例
假设有一个员工信息表，A列是部门名称：
- 技术部
- 市场部
- 人事部
- 财务部

拆分后会生成4个独立的Excel文件：
- `员工信息表_技术部.xlsx`
- `员工信息表_市场部.xlsx`
- `员工信息表_人事部.xlsx`
- `员工信息表_财务部.xlsx`

## 📦 打包更新

### 更新内容
- 更新了打包脚本以包含Excel拆分工具
- 更新了依赖文件，添加了pandas和openpyxl
- 修复了路径配置问题
- 更新了便携版使用说明

### 生成的文件
- `dist/gametools.exe` - 主程序（38.53 MB）
- `dist/gametools_便携版/` - 便携版包
  - `gametools.exe` - 便携版程序
  - `使用说明.txt` - 使用说明

### 技术信息
- 构建时间：2025-10-10 20:41:21
- Python版本：3.12.10
- PyInstaller版本：6.14.2
- 文件大小：38.53 MB

## 🔧 技术实现

### 新增文件
```
tools/excel_splitter/
├── excel_splitter.py          # 核心功能
├── excel_splitter_gui.py     # GUI界面
├── demo.py                   # 演示文件创建
├── requirements.txt          # 依赖包
├── README.md                # 工具说明
├── 启动Excel拆分工具.bat      # 启动脚本
└── 测试Excel拆分工具.bat      # 测试脚本
```

### 依赖更新
- pandas>=1.3.0
- openpyxl>=3.0.0

### 集成更新
- 更新了`gui/gametools_unified.py`，添加Excel拆分工具页签
- 更新了`gui/build_unified.py`，包含新的打包配置
- 更新了`gui/requirements.txt`，添加必要依赖

## 🚀 使用方法

### 启动程序
1. 直接运行 `dist/gametools.exe`
2. 或使用便携版包中的程序

### 功能页签
1. **策划本地化工具** - 检测表格文件中的越南文
2. **JSON格式检测工具** - 检测JSON文件格式一致性
3. **Excel拆分工具** - 根据指定列拆分Excel文件（新增）
4. **关于** - 程序信息

## 📋 注意事项

1. **文件格式**：支持.xlsx和.xls格式的Excel文件
2. **列名处理**：如果指定列不存在，会自动使用第一列
3. **文件名清理**：输出文件名中的非法字符会被替换为下划线
4. **空值处理**：空值和重复值会被自动处理
5. **目录创建**：输出目录不存在时会自动创建
6. **备份建议**：建议在拆分前备份原始文件

## 🐛 修复问题

- 修复了打包脚本中的路径配置问题
- 修复了GUI代码中的语法错误
- 更新了依赖文件配置

## 📞 技术支持

如有问题或建议，请联系开发团队。

---

**版本信息**
- 版本：v1.1.0
- 发布日期：2025-10-10
- 版权所有 © 2024 gametools
