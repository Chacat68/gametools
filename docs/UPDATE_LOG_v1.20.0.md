# GameTools 更新日志 - v1.20.0

**更新日期**: 2025-11-12  
**版本**: v1.20.0

## 🎉 主要更新

### ✨ 翻译提取工具 - 多语言版本

对Excel文本提取工具进行了重大升级，新增多语言并行处理功能。

#### 核心改进

1. **多语言路径配置**
   - ✅ 支持5种语言独立配置：中文版、越南文版、英文版、韩文版、日文版
   - ✅ 每种语言可以选择单个文件或目录
   - ✅ 灵活的路径管理：添加、清除、预览
   - ✅ 智能的默认输出目录设置

2. **独立输出管理**
   - ✅ 每种语言创建独立的输出子文件夹
   - ✅ 文件夹名称基于语言标识（自动清理特殊字符）
   - ✅ 便于分类管理和使用
   - ✅ 避免不同语言版本的文件冲突

3. **增强的用户界面**
   - ✅ 更大的窗口尺寸（900x750）适应多语言配置
   - ✅ 清晰的分区布局：语言配置、输出配置、选项、进度、结果
   - ✅ 实时进度反馈：每种语言的处理状态
   - ✅ 详细的处理日志：带图标的彩色日志输出

4. **智能处理逻辑**
   - ✅ 支持文件和目录混合配置
   - ✅ 自动检测路径类型并相应处理
   - ✅ 分语言处理，互不干扰
   - ✅ 统一的错误处理和容错机制

5. **完善的报告系统**
   - ✅ 分语言统计：每种语言的成功/失败文件数
   - ✅ 总体统计：所有语言的汇总数据
   - ✅ 实时进度显示：处理进度和百分比
   - ✅ 详细的日志输出：每个文件的处理状态

## 📊 功能对比

| 功能 | 原版本 | v1.20.0 |
|-----|-------|---------|
| 语言配置 | 单一目录 | 5种语言独立配置 |
| 路径类型 | 仅目录 | 文件+目录 |
| 输出结构 | 单一目录 | 分语言子目录 |
| 路径管理 | 基础浏览 | 添加/清除/预览 |
| 处理报告 | 单一报告 | 分语言+总体 |
| 窗口大小 | 800x600 | 900x750 |

## 🎯 使用场景

### 场景1: 多语言版本对比
同时提取所有语言版本的文本，进行文本数量对比、翻译完整性检查

### 场景2: 翻译工作量评估
为每种语言提取文本后，统计各语言的文本总量，评估翻译工作量

### 场景3: 本地化质量保证
同时处理多个语言版本，检查翻译遗漏、发现格式问题

### 场景4: 增量更新处理
只配置有更新的语言版本，快速提取新增或修改的文本

## 📝 文件变更

### 新增文件
- `docs/MULTI_LANGUAGE_TEXT_EXTRACTOR.md` - 多语言功能使用说明
- `docs/UPDATE_LOG_v1.20.0.md` - 本更新日志

### 修改文件
- `tools/excel_text_extractor_gui.py` - 核心GUI文件，添加多语言支持
- `README.md` - 更新功能说明

## 🔧 技术细节

### 界面改进
```python
# 语言路径配置字典
self.language_paths = {
    '中文版': tk.StringVar(),
    '越南文版': tk.StringVar(),
    '英文版': tk.StringVar(),
    '韩文版': tk.StringVar(),
    '日文版': tk.StringVar(),
}
```

### 处理流程
```
1. 用户配置多种语言路径
2. 系统验证路径有效性
3. 创建输出目录结构
4. 逐语言处理：
   - 扫描文件（文件/目录）
   - 提取文本
   - 创建输出Excel
   - 保存到对应子文件夹
5. 生成统计报告
```

### 输出结构
```
输出目录/
├── 中文/           # 中文版结果
│   └── ...
├── 越南文/         # 越南文版结果
│   └── ...
├── 英文/           # 英文版结果
│   └── ...
└── ...
```

## 💡 使用示例

### 示例配置
```
中文版:     D:\项目\中文版\
越南文版:   D:\项目\越南版配置.xlsx
英文版:     D:\项目\英文版\
输出目录:   D:\提取结果\
```

### 处理结果
```
================================================================================
📊 处理完成 - 总体统计
================================================================================
🌍 处理语言数: 3 种
✅ 成功文件数: 15
❌ 失败文件数: 0
📁 输出目录: D:\提取结果\
================================================================================
```

## 🔄 向后兼容性

- ✅ 保留所有原有的文本提取功能
- ✅ 支持单语言模式（只配置一种语言）
- ✅ 输出格式完全兼容原版本
- ✅ 命令行工具保持不变

## 📚 文档更新

1. **多语言使用说明**: `docs/MULTI_LANGUAGE_TEXT_EXTRACTOR.md`
   - 详细的功能介绍
   - 完整的操作步骤
   - 丰富的使用示例
   - 应用场景说明

2. **README更新**: 添加多语言功能说明

3. **更新日志**: 本文档记录所有改进内容

## ⚠️ 注意事项

1. **路径配置**: 至少需要配置一种语言的路径
2. **磁盘空间**: 多语言处理需要更多的磁盘空间
3. **处理时间**: 处理时间与配置的语言数量成正比
4. **内存使用**: 同时处理多个大文件时注意内存使用

## 🚀 性能优化

- ✅ 逐语言顺序处理，避免资源冲突
- ✅ 为每种语言创建独立的提取器实例
- ✅ 完善的进度反馈机制
- ✅ 多线程界面，不阻塞用户操作

## 🐛 Bug修复

- 修正了原版本中的一些小问题
- 改进了错误处理机制
- 增强了路径验证逻辑

## 📞 技术支持

如有问题或建议，请：
1. 查看 `docs/MULTI_LANGUAGE_TEXT_EXTRACTOR.md`
2. 检查 `tools/excel_text_extractor/README.md`
3. 查看源代码注释

## 🎯 后续计划

- [ ] 支持更多语言版本配置
- [ ] 添加语言版本模板管理
- [ ] 支持配置文件保存和加载
- [ ] 添加文本对比功能
- [ ] 支持导出对比报告

---

**开发团队**: gametools开发团队  
**发布日期**: 2025-11-12  
**版本**: v1.20.0
