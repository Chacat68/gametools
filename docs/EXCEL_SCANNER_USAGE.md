# Excel越南文扫描导出工具使用说明

## 功能概述

Excel越南文扫描导出工具是一个专门用于扫描整个文件夹下所有Excel文件，检测其中的越南文文本，并将结果导出到Excel文件的工具。

## 主要功能

### 1. 全文件夹扫描
- 递归扫描指定目录及其所有子目录
- 自动识别Excel文件格式（.xlsx, .xls）
- 支持大量文件的批量处理

### 2. 越南文检测
- 精确识别越南文字符和声调符号
- 支持所有越南语声调变体
- 忽略大小写差异

### 3. 位置定位
- 精确定位越南文在表格中的行列位置
- 记录工作表名称和列名
- 显示具体的越南文内容

### 4. 结果导出
- 将检测结果导出到格式化的Excel文件
- 包含详细的统计信息
- 支持自定义输出文件位置

## 使用方法

### 图形界面使用

1. **启动程序**
   ```bash
   python gui/run_unified.py
   ```

2. **选择功能页签**
   - 在GUI界面中选择"Excel扫描导出"页签

3. **设置扫描参数**
   - 点击"浏览目录"选择要扫描的文件夹
   - 点击"选择输出位置"选择输出Excel文件位置

4. **开始扫描**
   - 点击"开始扫描导出"按钮
   - 观察进度条和状态信息

5. **查看结果**
   - 在结果区域查看扫描统计信息
   - 打开生成的Excel文件查看详细结果

### 命令行使用

```bash
python core/excel_vietnamese_scanner.py [扫描目录] [输出文件]
```

示例：
```bash
python core/excel_vietnamese_scanner.py "C:\MyExcelFiles" "C:\Results\scan_results.xlsx"
```

## 输出文件格式

生成的Excel文件包含以下列：

| 列名 | 说明 |
|------|------|
| 序号 | 自动编号 |
| 文件名 | 包含越南文的Excel文件名 |
| 位置 | Excel单元格引用格式（如"C5"） |
| 越南文内容 | 具体的越南文文本内容 |

## 越南文字符支持

工具支持以下越南文字符：

### 声调字母
- **a系列**: àáạảãâầấậẩẫăằắặẳẵ
- **e系列**: èéẹẻẽêềếệểễ
- **i系列**: ìíịỉĩ
- **o系列**: òóọỏõôồốộổỗơờớợởỡ
- **u系列**: ùúụủũưừứựửữ
- **y系列**: ỳýỵỷỹ
- **特殊字符**: đ (带横线的d)

### 大小写支持
- 同时支持大写和小写越南文字符
- 自动忽略大小写差异

## 使用示例

### 示例1：扫描项目文件夹
```
扫描目录: D:\Project\Localization\ExcelFiles
输出文件: D:\Results\vietnamese_scan_results.xlsx

结果:
- 扫描了15个Excel文件
- 发现3个文件包含越南文
- 总共找到12个越南文位置
```

### 示例2：扫描游戏资源文件夹
```
扫描目录: C:\GameAssets\TextFiles
输出文件: C:\Reports\game_text_scan.xlsx

结果:
- 扫描了8个Excel文件
- 发现2个文件包含越南文
- 总共找到7个越南文位置
```

## 注意事项

1. **文件权限**: 确保程序有读取扫描目录和写入输出文件的权限
2. **文件占用**: 扫描过程中避免打开要扫描的Excel文件
3. **大文件处理**: 对于包含大量数据的Excel文件，扫描可能需要较长时间
4. **编码支持**: 支持各种编码格式的Excel文件
5. **内存使用**: 大量文件扫描时注意内存使用情况

## 错误处理

程序具有完善的错误处理机制：

- **文件读取错误**: 自动跳过无法读取的文件并记录错误
- **编码错误**: 自动尝试多种编码格式
- **权限错误**: 显示友好的错误提示信息
- **格式错误**: 自动识别并跳过非Excel文件

## 性能优化

- **多线程处理**: 界面操作在后台线程执行，保持界面响应
- **内存优化**: 逐个文件处理，避免内存溢出
- **进度显示**: 实时显示扫描进度和状态信息
- **错误恢复**: 单个文件错误不影响整体扫描进程
