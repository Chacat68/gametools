# 多语言文本提取工具使用说明

## 📋 功能概述

多语言文本提取工具是对原有翻译提取功能的增强版本，支持同时为多种语言版本的Excel文件提取文本内容。每种语言可以独立配置文件或目录路径，系统将自动为每种语言创建独立的输出子文件夹。

## ✨ 新增功能

### 1. 多语言路径配置

- ✅ **中文版**: 配置中文版本的Excel文件或目录
- ✅ **越南文版**: 配置越南文版本的Excel文件或目录
- ✅ **英文版**: 配置英文版本的Excel文件或目录
- ✅ **韩文版**: 配置韩文版本的Excel文件或目录
- ✅ **日文版**: 配置日文版本的Excel文件或目录

### 2. 灵活的路径类型

每种语言支持两种路径类型：

- **单个文件**: 直接选择一个Excel文件进行处理
- **目录批量**: 选择包含多个Excel文件的目录，批量处理

### 3. 独立输出管理

- 每种语言的提取结果保存在独立的子文件夹中
- 文件夹名称基于语言标识（如：中文、越南文、英文等）
- 便于后续分类管理和使用

## 🎮 使用方法

### 启动方式

```bash
# 方式1: 直接运行GUI
python tools/excel_text_extractor_gui.py

# 方式2: 使用启动脚本
tools\start_excel_text_extractor.bat

# 方式3: 通过统一界面
python gui/gametools_unified.py
# 然后选择"翻译提取"页签
```

### 操作步骤

#### 步骤1: 配置语言文件路径

1. 在"多语言文件路径配置"区域，为需要处理的语言点击"浏览"按钮
2. 在弹出的对话框中选择：
   - **是(Y)**: 选择单个Excel文件
   - **否(N)**: 选择包含多个Excel文件的目录
3. 选择完成后，路径会自动填入对应的输入框
4. 可以配置多种语言，也可以只配置一种语言
5. 使用"✕"按钮可以清除已配置的路径

#### 步骤2: 设置输出目录

1. 在"输出配置"区域点击"浏览"按钮
2. 选择用于保存提取结果的目录
3. 如果不设置，系统会自动使用第一个语言路径的目录

#### 步骤3: 配置提取选项

- **递归扫描子目录**: 如果选择的是目录，勾选此项会扫描所有子目录
- **文本类型**: 选择要提取的文本类型（全部、中文、英文、中英混合）

#### 步骤4: 预览和提取

1. 点击"预览文件"查看将要处理的文件列表
2. 确认无误后，点击"开始提取"执行文本提取
3. 在结果区域查看实时处理进度和日志

## 📊 输出结构

### 目录结构

```
输出目录/
├── 中文/                    # 中文版提取结果
│   ├── 文件1.xlsx
│   ├── 文件2.xlsx
│   └── ...
├── 越南文/                  # 越南文版提取结果
│   ├── 文件1.xlsx
│   ├── 文件2.xlsx
│   └── ...
├── 英文/                    # 英文版提取结果
│   ├── 文件1.xlsx
│   └── ...
└── ...
```

### 输出文件格式

每个输出的Excel文件包含：

1. **提取汇总表**: 包含源文件信息和统计数据
2. **各工作表文本列表**: 每个工作表的提取文本，包含以下列：
   - **id列**: 原Excel文件的A列内容
   - **位置列**: Excel物理位置引用（如F7）
   - **字段名列**: 原Excel第5行的字段名
   - **doc列**: 文本类型分析（中文/越南文/混合等）
   - **name列**: 提取的文本内容

## 💡 使用示例

### 示例1: 提取单个语言版本

**场景**: 只需要提取中文版本的文本

1. 只为"中文版"配置路径
2. 选择输出目录
3. 点击"开始提取"

**结果**:
```
输出目录/
└── 中文/
    └── 游戏配置.xlsx
```

### 示例2: 同时提取多个语言版本

**场景**: 需要同时处理中文、越南文、英文三个版本

**配置**:
- 中文版: `D:\项目\中文版\`
- 越南文版: `D:\项目\越南文版\`
- 英文版: `D:\项目\英文版\`
- 输出目录: `D:\提取结果\`

**结果**:
```
D:\提取结果\
├── 中文/
│   ├── 活动配置.xlsx
│   ├── 物品数据.xlsx
│   └── 角色信息.xlsx
├── 越南文/
│   ├── 活动配置.xlsx
│   ├── 物品数据.xlsx
│   └── 角色信息.xlsx
└── 英文/
    ├── 活动配置.xlsx
    ├── 物品数据.xlsx
    └── 角色信息.xlsx
```

### 示例3: 混合文件和目录

**场景**: 中文版是目录，越南文版是单个文件

**配置**:
- 中文版: `D:\项目\中文版\` (目录)
- 越南文版: `D:\项目\越南版配置.xlsx` (文件)
- 输出目录: `D:\提取结果\`

**结果**:
```
D:\提取结果\
├── 中文/
│   ├── 文件1.xlsx
│   ├── 文件2.xlsx
│   └── ...
└── 越南文/
    └── 越南版配置.xlsx
```

## 📈 处理报告

处理完成后，系统会显示详细的报告：

```
================================================================================
📚 处理语言 [1/3]: 中文版
================================================================================
📁 扫描目录: D:\项目\中文版\
✅ 成功处理: 5 个文件
❌ 处理失败: 0 个文件

================================================================================
📚 处理语言 [2/3]: 越南文版
================================================================================
📁 扫描目录: D:\项目\越南文版\
✅ 成功处理: 5 个文件
❌ 处理失败: 0 个文件

================================================================================
📚 处理语言 [3/3]: 英文版
================================================================================
📁 扫描目录: D:\项目\英文版\
✅ 成功处理: 5 个文件
❌ 处理失败: 0 个文件

================================================================================
📊 处理完成 - 总体统计
================================================================================
🌍 处理语言数: 3 种
✅ 成功文件数: 15
❌ 失败文件数: 0
📁 输出目录: D:\提取结果\
================================================================================
```

## 🎯 应用场景

### 场景1: 多语言版本对比

提取所有语言版本的文本后，可以进行：
- 文本数量对比
- 翻译完整性检查
- 术语一致性验证

### 场景2: 翻译工作量评估

为每种语言提取文本后，可以：
- 统计各语言的文本总量
- 评估翻译工作量
- 制定翻译计划

### 场景3: 本地化质量保证

同时处理多个语言版本，便于：
- 检查翻译遗漏
- 发现格式问题
- 确保多语言同步

### 场景4: 增量更新处理

当游戏更新时：
- 只配置有更新的语言版本
- 快速提取新增或修改的文本
- 高效完成增量翻译

## ⚙️ 技术特点

| 特性 | 说明 |
|-----|-----|
| 🌍 **多语言支持** | 同时支持5种语言配置 |
| 🔄 **灵活配置** | 支持文件和目录混合配置 |
| 📁 **独立输出** | 每种语言独立的输出目录 |
| 🎯 **精确提取** | 保持原有的精确定位功能 |
| 📊 **详细报告** | 分语言和总体的统计报告 |
| 🚀 **批量高效** | 多线程处理，性能优异 |
| 💾 **智能管理** | 自动创建目录结构 |

## 🔍 特殊说明

### 1. 策划行检测

- 如果Excel文件第6行包含"策划"关键字，将跳过整个文件的文本提取
- 这个规则对所有语言版本都生效

### 2. 文本提取规则

- 从Excel物理第7行开始检测
- 同时提取A列内容作为ID关联
- 保留第5行作为字段名
- 支持中文和越南文，跳过纯英文

### 3. 文件命名

- 输出文件名与源文件名相同
- 格式统一为`.xlsx`
- 如果文件已存在，会被覆盖

### 4. 目录创建

- 输出子目录会自动创建
- 目录名基于语言标识，不包含"版"字
- 例如：中文版 → 中文，越南文版 → 越南文

## ⚠️ 注意事项

1. **路径有效性**: 确保配置的路径存在且可访问
2. **磁盘空间**: 确保输出目录有足够的磁盘空间
3. **文件格式**: 仅支持`.xlsx`和`.xls`格式
4. **编码兼容**: 自动处理UTF-8、GBK等编码
5. **并发处理**: 按顺序处理每种语言，避免资源冲突

## 🆚 与原版本的区别

| 功能 | 原版本 | 多语言版本 |
|-----|-------|----------|
| 路径配置 | 单一输入目录 | 5种语言独立配置 |
| 文件类型 | 仅支持目录 | 支持文件和目录 |
| 输出结构 | 单一输出目录 | 分语言子目录 |
| 处理报告 | 单一报告 | 分语言+总体报告 |
| 使用场景 | 单语言处理 | 多语言并行处理 |

## 📞 技术支持

如有问题或建议，请查看：
- 项目文档：`docs/`目录
- 测试用例：`test/`目录
- 源代码：`tools/excel_text_extractor_gui.py`

---

**版本**: v1.20.0+  
**更新日期**: 2025-11-12  
**适用范围**: 游戏本地化、多语言文本管理
