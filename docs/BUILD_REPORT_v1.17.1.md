# gametools v1.17.1 构建报告

## 📋 构建信息

- **版本号**: v1.17.1
- **构建日期**: 2025-01-11
- **构建时间**: 2025-01-11 18:56:25
- **Python版本**: 3.12.10
- **PyInstaller版本**: 6.14.2
- **文件大小**: 38.66 MB

## 🆕 新功能更新

### E列语言类型检测逻辑优化

#### 主要改进
1. **修改语言类型检测方式**：基于实际检测到的Excel单元格内容判断语言类型
2. **优化检测准确性**：不再固定判断D列，而是根据实际扫描到的内容进行语言类型识别
3. **增强检测逻辑**：在扫描Excel文件时实时判断每个单元格的语言类型
4. **提升检测精度**：确保E列显示的语言类型与实际检测内容完全匹配
5. **完善注释说明**：添加详细的代码注释说明检测逻辑
6. **保持向后兼容**：现有功能完全保持不变，仅优化检测逻辑

#### 技术实现
- **修改文件**: `core/vietnamese_excel_processor.py`, `core/excel_vietnamese_scanner.py`
- **检测逻辑**: 在扫描Excel文件时，对每个包含越南文的单元格实时进行语言类型检测
- **检测对象**: 实际检测到的单元格内容（`str(value)`）
- **检测方法**: `self.vietnamese_detector.detect_language_type(content)`

#### 语言类型支持
- **英文**: 纯英文内容
- **越南文**: 纯越南文内容  
- **中文**: 纯中文内容
- **中越混合**: 中文和越南文混合
- **越英混合**: 越南文和英文混合
- **其他**: 其他语言或特殊字符

## 📦 构建产物

### 主程序文件
- `gametools_v1.17.1.exe` - 主程序（带版本号，推荐使用）
- `gametools.exe` - 主程序（兼容性版本）

### 便携版包
- `gametools_v1.17.1_便携版/` - 便携版包（带版本号，推荐使用）
  - `gametools.exe` - 主程序
  - `使用说明.txt` - 使用说明文档
- `gametools_便携版/` - 便携版包（兼容性版本）
  - `gametools.exe` - 主程序
  - `使用说明.txt` - 使用说明文档

## 🎯 功能模块

### 1. 越南文检测导出工具
- **批量扫描**: 检测目录下所有表格文件中的越南文内容
- **精确定位**: 单文件详细分析，定位越南文在表格中的具体位置
- **递归扫描**: 支持扫描子目录中的所有表格文件
- **多格式支持**: 支持 Excel (.xlsx, .xls) 和 CSV (.csv, .tsv) 文件
- **语言类型检测**: 自动检测文本内容的语言类型（6种类型）
- **结果导出**: 将检测结果导出到Excel文件，包含详细的位置信息
- **演示功能**: 一键创建测试文件进行功能验证

### 2. JSON错误检测工具
- **语法错误检测**: 检测尾随逗号、单引号、注释等JSON标准不允许的语法
- **结构错误检测**: 检测JSON结构问题
- **编码错误检测**: 检测文件编码问题
- **文件夹批量检测**: 支持检测整个文件夹中的所有JSON文件
- **递归搜索**: 自动搜索子文件夹中的JSON文件
- **智能路径识别**: 自动识别输入的是文件还是文件夹
- **详细报告**: 生成完整的检测报告，包含错误类型、位置、严重程度
- **保存功能**: 支持保存检测结果到文件

### 3. Excel数据处理工具
- **智能分组**: 根据指定列（默认A列）内容自动分组数据
- **多工作表输出**: 创建单个Excel文件包含多个工作表
- **自动文件名**: 根据分组内容自动生成有意义的文件名
- **重复检测**: 自动跳过已存在的文件，避免覆盖
- **汇总信息**: 可选择包含汇总统计信息
- **灵活配置**: 支持自定义分组列和工作表前缀
- **数据预览**: 支持预览Excel数据结构和内容

### 4. 翻译提取工具
- **批量文本提取**: 批量提取Excel文件中的文本内容
- **多语言支持**: 支持中文、越南文、英文多语言检测
- **智能过滤**: 跳过纯英文内容，专注中文和越南文
- **数值内容过滤**: 跳过纯数字、浮点数、数学表达式
- **数组格式过滤**: 跳过方括号、花括号、圆括号数组
- **JSON格式过滤**: 跳过JSON数组和对象格式
- **策划文件检测**: 自动检测和跳过策划文件
- **位置追溯**: 提供准确的Excel物理位置引用（如C7、D8）
- **字段名提取**: 显示原Excel字段名信息

## 🖥️ 界面特性

- **多页签设计**: 将多个功能模块整合在一个界面中
- **现代化UI**: 基于tkinter的现代化图形界面
- **实时进度显示**: 多线程处理，界面响应流畅
- **状态图标**: 🚀开始、ℹ️信息、✅成功、❌失败、⏭️跳过
- **详细日志**: 实时显示处理进度和状态信息
- **错误处理**: 完善的错误提示和异常处理机制

## 🛠️ 技术特性

- **多线程处理**: 所有检测操作都在后台线程中执行
- **实时反馈**: 界面会实时显示操作进度和结果
- **错误处理**: 完善的错误提示和异常处理
- **结果保存**: 支持保存各种检测结果到文件
- **跨平台支持**: 支持Windows、macOS、Linux

## 📋 使用说明

### 快速开始
1. 直接运行 `dist/gametools_v1.17.1.exe`（推荐）
2. 或运行 `dist/gametools.exe`（兼容性版本）
3. 或使用便携版包 `gametools_v1.17.1_便携版/` 中的程序
4. 或使用便携版包 `gametools_便携版/` 中的程序

### 功能使用
1. 选择相应的功能页签
2. 按照界面提示操作
3. 查看检测结果
4. 保存或导出结果

## ⚠️ 注意事项

- 确保文件格式正确
- 大文件处理可能需要较长时间
- 建议在检测前备份重要文件
- 首次运行可能需要管理员权限

## 🔄 版本历史

### v1.17.1 (2025-01-11)
- E列语言类型检测逻辑优化
- 修改语言类型检测方式：基于实际检测到的Excel单元格内容判断语言类型
- 优化检测准确性：不再固定判断D列，而是根据实际扫描到的内容进行语言类型识别
- 增强检测逻辑：在扫描Excel文件时实时判断每个单元格的语言类型
- 提升检测精度：确保E列显示的语言类型与实际检测内容完全匹配
- 完善注释说明：添加详细的代码注释说明检测逻辑
- 保持向后兼容：现有功能完全保持不变，仅优化检测逻辑

### v1.17.0 (2025-01-11)
- 越南文检测导出工具重大升级
- 新增E列语言类型检测功能：自动检测D列文本内容的语言类型
- 支持6种语言类型识别：英文、越南文、中文、中越混合、越英混合、其他
- 增强语言检测算法：新增英文检测功能，优化混合语言识别
- 更新输出格式：E列宽度15个字符，显示语言类型信息
- 完善检测逻辑：同时支持Excel和CSV文件的语言类型检测
- 提升用户体验：更详细的语言分析信息，便于翻译工作规划
- 保持向后兼容：现有功能完全保持不变，仅增加新功能

## 📞 技术支持

如有问题或建议，请联系开发团队。

---

**gametools v1.17.1**  
版权所有 © 2024 gametools开发团队
