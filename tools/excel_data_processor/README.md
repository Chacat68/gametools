# Excel数据处理工具使用说明

## 工具简介

Excel数据处理工具是一个专门用于处理Excel文件的工具，它可以根据A列（或指定列）的内容对数据进行分组，并将相同内容的数据处理到新的Excel文件中。每个分组会创建一个独立的工作表。

## 功能特性

- **智能分组**: 根据A列内容自动分组数据
- **多工作表输出**: 每个分组创建独立的工作表
- **汇总信息**: 可选择包含汇总统计信息
- **灵活配置**: 支持自定义分组列和工作表前缀
- **图形界面**: 提供友好的GUI界面
- **命令行支持**: 支持命令行批量处理

## 使用方法

### 1. GUI界面模式

#### 启动方式
```bash
# 方式1: 直接运行GUI
python tools/excel_data_processor_gui.py

# 方式2: 使用启动脚本
tools/start_excel_data_processor.bat

# 方式3: 通过主界面
python gui/gametools_unified.py
```

#### 操作步骤
1. **选择输入文件**: 点击"浏览"按钮选择要处理的Excel文件
2. **选择输出文件夹**: 点击"浏览"按钮选择输出文件夹
3. **设置输出文件名**: 输入处理后文件的名称（默认为"处理结果.xlsx"）
4. **配置选项**:
   - **分组列**: 指定用于分组的列名（留空使用第一列）
   - **工作表前缀**: 为生成的工作表添加前缀
   - **包含汇总信息**: 是否在输出文件中包含汇总统计
5. **预览数据**: 点击"预览数据"查看文件内容和分组情况
6. **开始处理**: 点击"开始处理"按钮执行处理
7. **查看结果**: 在结果区域查看处理报告

### 2. 命令行模式

#### 基本用法
```bash
python tools/excel_splitter.py input_file.xlsx output_folder
```

#### 高级选项
```bash
python tools/excel_data_processor.py input_file.xlsx output_folder \
    --output-filename "自定义文件名.xlsx" \
    --group-column "列名" \
    --sheet-prefix "前缀" \
    --no-summary
```

#### 参数说明
- `input_file.xlsx`: 输入Excel文件路径
- `output_folder`: 输出文件夹路径
- `--output-filename`: 输出文件名（默认为"处理结果.xlsx"）
- `--group-column`: 指定分组列名（默认为第一列）
- `--sheet-prefix`: 工作表名称前缀
- `--no-summary`: 不包含汇总信息工作表

## 使用示例

### 示例数据
假设您有一个包含以下数据的Excel文件：

| 文件名 | 分类 | ID | 中文描述 | 越南文描述 |
|--------|------|----|---------|-----------| 
| act_20206_shilian_0.xlsx | des | 1080601 | 神兵天降 | Thần Binh Thiên Giáng |
| act_20206_shilian_0.xlsx | des | 1090601 | 罗刹试炼 | Thí Luyện La Sát |
| act_23201_rank_flower_list.xlsx | task_name | 5010501 | 合服狂欢-花语心愿 | Gộp Server - Hoa Tâm Nguyện |
| act_23201_rank_flower_list.xlsx | task_name | 5010501 | 登录1次 | Đăng nhập 1 lần |

### 处理结果
工具会根据"文件名"列进行分组，生成包含以下工作表的Excel文件：

1. **act_20206_shilian_0.xlsx** 工作表
   - 包含所有文件名为此值的行数据

2. **act_23201_rank_flower_list.xlsx** 工作表
   - 包含所有文件名为此值的行数据

3. **汇总信息** 工作表（可选）
   - 包含分组统计信息

## 技术规格

### 支持的文件格式
- Excel文件: `.xlsx`, `.xls`
- 编码: UTF-8

### 系统要求
- Python 3.7+
- pandas >= 1.3.0
- openpyxl >= 3.0.0
- tkinter (GUI界面)

### 性能特点
- 支持大文件处理
- 多线程处理，界面响应流畅
- 内存优化，适合处理大量数据

## 注意事项

1. **文件备份**: 处理前建议备份原始文件
2. **工作表名称**: Excel工作表名称有长度限制（31个字符）
3. **特殊字符**: 分组值中的特殊字符会被替换为下划线
4. **空值处理**: 空值会被归类到"空值"分组中
5. **编码问题**: 确保Excel文件使用UTF-8编码

## 故障排除

### 常见问题

1. **文件读取失败**
   - 检查文件路径是否正确
   - 确认文件格式是否为支持的Excel格式
   - 检查文件是否被其他程序占用

2. **分组结果异常**
   - 检查分组列是否存在
   - 确认分组列名拼写正确
   - 预览数据查看分组情况

3. **输出文件创建失败**
   - 检查输出路径是否有写入权限
   - 确认输出文件没有被其他程序占用
   - 检查磁盘空间是否充足

### 错误信息
- `文件不存在`: 检查输入文件路径
- `不支持的文件格式`: 确认文件为Excel格式
- `分组列不存在`: 检查分组列名是否正确
- `处理失败`: 查看详细错误信息进行排查

## 更新日志

### v1.0.0 (2024-10-10)
- 初始版本发布
- 支持基本的Excel数据处理功能
- 提供GUI和命令行两种使用方式
- 支持自定义分组列和工作表前缀
- 包含汇总信息功能

## 技术支持

如有问题或建议，请联系开发团队或查看项目文档。

---

**版权所有 © 2024 gametools**
