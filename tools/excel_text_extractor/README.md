# 翻译提取使用说明

## 工具简介

翻译提取是一个专门用于检测目录中的Excel文件并提取文本内容的工具。它能够自动扫描指定目录中的所有Excel文件，提取其中的文本内容，并为每个文件创建一个同名的新Excel文件，包含提取的文本信息。

## 功能特性

- **智能文本识别**: 自动识别Excel文件中的文本内容，过滤数字、日期等非文本数据
- **批量处理**: 支持批量处理目录中的所有Excel文件
- **多工作表支持**: 处理包含多个工作表的Excel文件
- **文本分类**: 自动分析文本类型（中文、英文、中英混合等）
- **详细统计**: 提供提取过程的详细统计信息
- **图形界面**: 提供友好的GUI界面
- **命令行支持**: 支持命令行批量处理

## 使用方法

### 1. GUI界面模式

#### 启动方式
```bash
# 方式1: 直接运行GUI
python tools/excel_text_extractor_gui.py

# 方式2: 使用启动脚本
tools/start_excel_text_extractor.bat

# 方式3: 通过主界面
python gui/gametools_unified.py
```

#### 操作步骤
1. **选择输入目录**: 点击"浏览"按钮选择包含Excel文件的目录
2. **选择输出目录**: 点击"浏览"按钮选择输出目录（默认为输入目录）
3. **配置选项**:
   - **递归扫描子目录**: 是否扫描子目录中的Excel文件
   - **文本类型过滤**: 选择要提取的文本类型（全部、中文、英文、中英混合）
4. **预览文件**: 点击"预览文件"查看目录中的Excel文件列表
5. **开始提取**: 点击"开始提取"按钮执行文本提取
6. **查看结果**: 在结果区域查看提取报告

### 2. 命令行模式

#### 基本用法
```bash
python tools/excel_text_extractor.py input_directory
```

#### 高级选项
```bash
python tools/excel_text_extractor.py input_directory \
    --output-directory output_directory \
    --recursive
```

#### 参数说明
- `input_directory`: 输入目录路径（必需）
- `--output-directory`: 输出目录路径（默认为输入目录）
- `--recursive`: 递归扫描子目录

## 输出文件格式

### 文件命名规则
- 输出文件名格式：`原文件名_文本提取.xlsx`
- 例如：`test_data.xlsx` → `test_data_文本提取.xlsx`

### 输出文件结构
每个输出文件包含以下工作表：

1. **提取汇总** 工作表
   - 源文件信息
   - 工作表数量统计
   - 提取文本总数
   - 各工作表文本数量统计

2. **各工作表文本列表**
   - 序号：文本在原始文件中的序号
   - 文本内容：提取的文本内容
   - 文本长度：文本字符数
   - 字符类型：文本类型分析（中文、英文、中英混合等）

## 使用示例

### 示例数据
假设您有一个包含以下Excel文件的目录：

```
data/
├── activity.xlsx          # 活动数据
├── items.xlsx            # 物品数据
└── characters.xlsx       # 角色数据
```

### 处理结果
工具会为每个文件创建对应的文本提取文件：

```
data/
├── activity.xlsx
├── activity_文本提取.xlsx    # 新生成
├── items.xlsx
├── items_文本提取.xlsx      # 新生成
├── characters.xlsx
└── characters_文本提取.xlsx # 新生成
```

### 文本提取示例
原始Excel文件内容：
| 活动名称 | 描述 | 奖励 |
|---------|------|------|
| 每日签到 | 每日登录签到 | 经验+100 |
| 副本挑战 | 挑战副本获得奖励 | 金币+500 |

提取后的文本文件内容：
| 序号 | 文本内容 | 文本长度 | 字符类型 |
|------|---------|---------|----------|
| 1 | 每日签到 | 4 | 中文 |
| 2 | 每日登录签到 | 6 | 中文 |
| 3 | 经验+100 | 6 | 中英混合 |
| 4 | 副本挑战 | 4 | 中文 |
| 5 | 挑战副本获得奖励 | 8 | 中文 |
| 6 | 金币+500 | 6 | 中英混合 |

## 技术规格

### 支持的文件格式
- Excel文件: `.xlsx`, `.xls`
- 编码: UTF-8

### 系统要求
- Python 3.7+
- pandas >= 1.3.0
- openpyxl >= 3.0.0
- tkinter (GUI界面)

### 性能特点
- 支持大文件处理
- 多线程处理，界面响应流畅
- 内存优化，适合处理大量数据
- 智能文本识别，准确率高

## 注意事项

1. **文件备份**: 处理前建议备份原始文件
2. **文本识别**: 工具会自动过滤数字、日期等非文本内容
3. **编码问题**: 确保Excel文件使用UTF-8编码
4. **文件权限**: 确保对输入和输出目录有读写权限
5. **重复处理**: 避免对输出文件再次进行文本提取

## 故障排除

### 常见问题

1. **文件读取失败**
   - 检查文件是否损坏
   - 确认文件格式是否支持
   - 检查文件权限

2. **文本提取不完整**
   - 检查Excel文件中的文本格式
   - 确认文本内容是否被识别为文本类型

3. **输出文件创建失败**
   - 检查输出目录权限
   - 确认磁盘空间是否充足
   - 检查文件名是否包含非法字符

### 性能优化建议

1. **大文件处理**: 对于大型Excel文件，建议分批处理
2. **内存使用**: 处理大量文件时注意内存使用情况
3. **网络存储**: 避免在网络驱动器上直接处理文件

## 更新日志

### v1.0.0 (2024-10-11)
- 初始版本发布
- 支持Excel文件文本提取
- 提供GUI和命令行两种使用方式
- 支持批量处理和多工作表文件
- 智能文本类型识别
