# JSON错误检测工具

这个工具用于检测JSON文件中的各种错误，包括语法错误和编码错误。

## 功能特点

- **语法错误检测**：检测尾随逗号、单引号、注释等JSON标准不允许的语法
- **编码错误检测**：检测文件编码问题
- **详细错误报告**：生成包含错误位置和严重程度的详细报告

## 文件说明

- `json_error_detector.py` - 完整的错误检测工具（支持命令行参数）
- `detect_error.py` - 简化的使用脚本
- `example_data.json` - 包含各种错误的测试数据
- `syntax_error_example.json` - 包含语法错误的测试数据
- `requirements.txt` - 依赖说明（本工具只使用Python标准库）

## 使用方法

### 方法1：使用简化脚本
```bash
# 检测单个JSON文件
python detect_error.py example_data.json

# 检测文件夹中的所有JSON文件
python detect_error.py ./json_files/
```

### 方法2：使用完整工具
```bash
# 检测单个JSON文件
python json_error_detector.py example_data.json

# 检测文件夹中的所有JSON文件
python json_error_detector.py ./json_files/

```

### 方法3：输出到文件
```bash
# 检测文件并保存报告
python json_error_detector.py example_data.json --output report.txt

# 检测文件夹并保存报告
python json_error_detector.py ./json_files/ --output folder_report.txt
```

## 检测的错误类型

### 语法错误
- **尾随逗号**：对象或数组末尾的逗号
- **单引号**：JSON标准要求使用双引号
- **注释**：JSON标准不支持注释
- **JSON解析错误**：无法解析的JSON语法


### 编码错误
- **编码检测错误**：无法使用常见编码读取文件
- **编码警告**：文件包含非ASCII字符但未使用UTF-8编码

## 示例

### 检测单个文件
运行检测工具：
```bash
python detect_error.py syntax_error_example.json
```

输出示例：
```
正在检测文件: syntax_error_example.json

============================================================
JSON错误检测报告
============================================================
错误数量: 3
警告数量: 0

错误详情:
------------------------------
1. 单引号错误
   消息: 第10行使用了单引号，JSON标准要求使用双引号
   位置: 第10行, 第9列
   严重程度: error

2. 注释错误
   消息: 第11行包含注释，JSON标准不支持注释
   位置: 第11行, 第18列
   严重程度: error

3. 尾随逗号
   消息: 第7行对象中存在尾随逗号
   位置: 第7行, 第22列
   严重程度: error
```

### 检测文件夹
运行检测工具：
```bash
python detect_error.py ./json_files/
```

输出示例：
```
正在检测文件夹: ./json_files/

================================================================================
JSON文件夹错误检测报告
================================================================================
检测文件夹: ./json_files/
找到JSON文件数量: 3

[1/3] 检测文件: valid_example.json
------------------------------------------------------------
JSON文件没有发现错误！

[2/3] 检测文件: syntax_error_example.json
------------------------------------------------------------
  1. 单引号错误
  2. 注释错误
  3. 尾随逗号

[3/3] 检测文件: example_data.json
------------------------------------------------------------
  1. 尾随逗号
  2. 单引号错误
  3. 注释错误

================================================================================
检测总结
================================================================================
处理文件数量: 3/3
总错误数量: 6
总警告数量: 0
⚠️  发现 6 个错误和 0 个警告
```

## 技术实现

工具使用Python标准库实现，主要功能包括：

1. **文件读取** - 支持多种编码格式的文件读取
2. **语法分析** - 逐行检测JSON语法错误
3. **结构分析** - 递归检测JSON结构问题
4. **报告生成** - 生成详细的错误和警告报告

## 错误严重程度

- **error**：严重错误，会导致JSON解析失败或数据不正确
- **warning**：警告，不会导致解析失败但可能影响性能或不符合最佳实践

## 注意事项

1. 本工具严格按照JSON标准进行检测
2. 某些"错误"可能是特定应用场景下的合理用法
3. 建议在开发环境中使用，生产环境请谨慎使用
4. 工具会尝试修复一些简单的语法错误，但建议手动修复以确保正确性